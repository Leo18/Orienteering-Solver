package jp.co.worksap.global;

import java.util.Random;

/**
 * Created by Emperor on 30/10/14.
 */

/**
 * The MapGenerator is for testing use. The generator could generate random but valid grid maps
 * according to the width and height. The number of checkpoints is also constrained.
 */
public class MapGenerator {
    private int width, height;

    public MapGenerator(int width, int height) {
        this.width = width;
        this.height = height;
    }

    public static void main(String[] args) {
        MapGenerator generator = new MapGenerator(100, 100);
        for (int i = 0; i < 100; i++)
            for (String s : generator.generate()) {
                System.out.println(s);
            }
    }

    public String[] generate() {
        String[] map = new String[height];
        Random rand = new Random(System.nanoTime());

        int startRow, startCol, goalRow, goalCol;
        while (true) {
            startRow = rand.nextInt(height);
            rand.setSeed(System.nanoTime());
            startCol = rand.nextInt(width);
            rand.setSeed(System.nanoTime());
            goalCol = rand.nextInt(width);
            rand.setSeed(System.nanoTime());
            goalRow = rand.nextInt(height);
            rand.setSeed(System.nanoTime());
            if (startRow > 0 && startRow < height - 1 &&
                    startCol > 0 && startCol < width - 1 &&
                    goalRow > 0 && goalRow < height - 1 &&
                    goalCol > 0 && goalCol < width - 1 &&
                    !(startRow == goalRow && startCol == goalCol)) break;
        }

        final int MAX_CHECKPOINT = 18;
        int cnt = 0, c = 0;
        int divisor = rand.nextInt(80);
        for (int i = 0; i < height; i++) {
            String row = "";
            for (int j = 0; j < width; j++) {
                if (i == 0 || i == height - 1) {
                    row += "#";
                    continue;
                }
                if (j == 0 || j == width - 1) {
                    row += "#";
                    continue;
                }
                if (i == startRow && j == startCol) {
                    row += "S";
                    continue;
                }
                if (i == goalRow && j == goalCol) {
                    row += "G";
                    continue;
                }
                rand.setSeed(System.nanoTime());
                int x = rand.nextInt(100);
                if (x < 20)
                    row += "#";
                else if (x >= 30 && x < 99)
                    row += ".";
                else {
                    if (cnt <= MAX_CHECKPOINT) {
                        if (c % (divisor + 1) == 0) {
                            row += "@";
                            cnt++;
                            c++;
                        } else {
                            row += ".";
                            c++;
                        }
                    } else
                        row += ".";

                }
            }
            map[i] = row;
        }
        System.out.println("" + width + " " + height);
        return map;
    }
}
/*
100 40
####################################################################################################
##.#......##..@.............#..........#.#.#....##....#..#####........#...............#...##.#.....#
#.#..#.....#.##.#.#...#....#.....#.#...#...#..........#..#.#.S.#..#......#.....#....#..#..#......#.#
#..........#.#.....#.##.....#@.#..........#.....#..#....#.#..#.......##.##.#....#.........##.#.....#
#...#...#.........#...#.#.#........#....#.....#...#.#.#....#.#.#..#.....#....#...............#..#..#
#...#.#..#..........##.......@.......#..........##..#.#.#...#..........#....#...#....#............##
#.#......#.##......##...##.......#..............#......###..#.....#...#..#..#.#...#.....#..........#
#......#....#.@....##..#...#.#...#.#...##..................................#.#.#.#.#.#...#.........#
##...#.....#..##.#......#...#..##.......#.#.#.#.......#....##.....##.....#........#.......#..#.....#
#..........@#......#.#..#...#.#..#..#.#..#....................##............#.#...#...............##
#..#..................#....................#..####....#...#.....#.....#...#..#....#.#...#...#....#.#
#..##...#.....#..#.....#......#..#..#.#.#.....#.##..#...#..#...#..#.....#.#...#...#..........#...#.#
#..##...#.####.....@.......#.....#....#..#......#............#.#...#...#........#..#.#.#.....#.....#
#....#...#.........#.#.....#...#..#.#...#..###..#................#.....#....#..#..#........#.......#
#...#......#..........#....##.........#...###......@.##.....#..#.......#...............#...........#
#.......#.............#.#..#........#...#..........#..................#.....................#....#.#
##..###.#.#......###..#...#........#.....#.....@....#..#.........#.......#....#..........#.....#..##
#........#.###.........#..........#.......#....#.......##...#.........##...#.....#........#....#...#
#................#.......##.......##.....#..#.....#...#.........#.#.#........#..#....#......#...#.@#
##..#.........###............................#......#.#.#.##.#.#..#.#.#....#.........#.......#.....#
#......#..........#....#.........#..#.....#...##.#...#..##.....#..#.#...#.##......#..............#.#
#..........##..#..#..##..#..#.....##.@##..............#.##..........#....###........#...#......##..#
#...#.....#............................#......#.....##........#.#......#..#.......#....#....#......#
#....#.........##....#.#.###..#.....#...............##.#..........#..@.##..#......#.#.#.........#..#
#..####..........##...#.........##.#................#.#.......#............#...#..#..#....#....##.##
#..#.....#.#..#.#......#.......##.#.#...#....#.......##.........#.....#.....#...#......#.#.......#.#
#.....#...@..#.#.........#.....#..#....##...#....#..........#...#........#.#....#...#.....#.#.##...#
##...........#..#....##.#....###......#..#........##.....#....#......#......#.#.....#......#.##....#
#.......#......#.#......#...................#..#.#......#.##.....#@..#......#.............#.#.....##
#...#........##........#....#.......#......#..#.......#.#.....##...#....#..#........#..........#...#
#..#...........#.......#.....#...##......#..#..................#..@........####.#......#....#......#
#.......#...........##.........#......##.#.#..#..#.....#..#..#...#....#..................#.........#
#......#.#..G....#......##...#..................#.##..#.....#..#......##.#........##.....#.#.......#
##............#....##...##..@..#....#...#.....#..#..#........#....#...............#...#.#.##.#....##
##.#...#..#.......#..#...#...#.....#......#....#...................###...#....#.#...#..#..........##
#.........#.#.#..#...#.......#...................#..####@..........#.#....#.............#..........#
####....#...#..#...........#.#..#....#.......##..#....#...##.....#....#..###...##..............#...#
##........#.....#...#.##........#.#.#####....##...........#....#....#...............#.##...........#
##..#....#.@.......#...#.#.............#...#......#..#..#...##.........#....##....#.#..#......##...#
####################################################################################################
*/
